'use strict';

var serializeError = require('serialize-error');

module.exports = function (isExpress) {
  return function (err, req, res, next) {
    var serializedErr = serializeError(err);

    delete serializedErr.stack;

    if (serializedErr.errors) {
      for (var key in serializedErr.errors) {
        delete serializedErr.errors[key].stack;
      }
    }

    res.setHeader('Content-Type', 'application/json');

    if (isExpress) {
      res.status(req.erm.statusCode).send(serializedErr);
    } else {
      res.send(req.erm.statusCode, serializedErr);
    }
  };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9taWRkbGV3YXJlL29uRXJyb3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNLGlCQUFpQixRQUFRLGlCQUFSLENBQWpCOztBQUVOLE9BQU8sT0FBUCxHQUFpQixVQUFVLFNBQVYsRUFBcUI7QUFDcEMsU0FBTyxVQUFVLEdBQVYsRUFBZSxHQUFmLEVBQW9CLEdBQXBCLEVBQXlCLElBQXpCLEVBQStCO0FBQ3BDLFFBQU0sZ0JBQWdCLGVBQWUsR0FBZixDQUFoQixDQUQ4Qjs7QUFHcEMsV0FBTyxjQUFjLEtBQWQsQ0FINkI7O0FBS3BDLFFBQUksY0FBYyxNQUFkLEVBQXNCO0FBQ3hCLFdBQUssSUFBSSxHQUFKLElBQVcsY0FBYyxNQUFkLEVBQXNCO0FBQ3BDLGVBQU8sY0FBYyxNQUFkLENBQXFCLEdBQXJCLEVBQTBCLEtBQTFCLENBRDZCO09BQXRDO0tBREY7O0FBTUEsUUFBSSxTQUFKLENBQWMsY0FBZCxFQUE4QixrQkFBOUIsRUFYb0M7O0FBYXBDLFFBQUksU0FBSixFQUFlO0FBQ2IsVUFBSSxNQUFKLENBQVcsSUFBSSxHQUFKLENBQVEsVUFBUixDQUFYLENBQStCLElBQS9CLENBQW9DLGFBQXBDLEVBRGE7S0FBZixNQUVPO0FBQ0wsVUFBSSxJQUFKLENBQVMsSUFBSSxHQUFKLENBQVEsVUFBUixFQUFvQixhQUE3QixFQURLO0tBRlA7R0FiSyxDQUQ2QjtDQUFyQiIsImZpbGUiOiJvbkVycm9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2VyaWFsaXplRXJyb3IgPSByZXF1aXJlKCdzZXJpYWxpemUtZXJyb3InKVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXNFeHByZXNzKSB7XHJcbiAgcmV0dXJuIGZ1bmN0aW9uIChlcnIsIHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICBjb25zdCBzZXJpYWxpemVkRXJyID0gc2VyaWFsaXplRXJyb3IoZXJyKVxyXG5cclxuICAgIGRlbGV0ZSBzZXJpYWxpemVkRXJyLnN0YWNrXHJcblxyXG4gICAgaWYgKHNlcmlhbGl6ZWRFcnIuZXJyb3JzKSB7XHJcbiAgICAgIGZvciAobGV0IGtleSBpbiBzZXJpYWxpemVkRXJyLmVycm9ycykge1xyXG4gICAgICAgIGRlbGV0ZSBzZXJpYWxpemVkRXJyLmVycm9yc1trZXldLnN0YWNrXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXMuc2V0SGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbicpXHJcblxyXG4gICAgaWYgKGlzRXhwcmVzcykge1xyXG4gICAgICByZXMuc3RhdHVzKHJlcS5lcm0uc3RhdHVzQ29kZSkuc2VuZChzZXJpYWxpemVkRXJyKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnNlbmQocmVxLmVybS5zdGF0dXNDb2RlLCBzZXJpYWxpemVkRXJyKVxyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0=
//# sourceMappingURL=onError.js.map